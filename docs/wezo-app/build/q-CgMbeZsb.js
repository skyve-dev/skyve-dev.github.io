import{c as x,q as f,B as l,u as v,A as S,a as w,p as B,G as N,o as D,i as c,h as u,j as t,_hW as h}from"./q-DZXsFSfu.js";import{_}from"./q-BUuyHtLx.js";import{A as T}from"./q-CPNbsRLo.js";import{a as I,f as z}from"./q-BLbZb5VG.js";import"./q-DMNCs-Jg.js";import"./q-BME3mVt-.js";const K=x(f(()=>_(()=>Promise.resolve().then(()=>O),void 0),"s_Iguj0Nys0VI"));function g(n){const{value:o,onChange$:e,name:i,title:s,placeholder:m,style:p,description:r,type:y,inputMode:a,required:d,pattern:P,disabled:b,maxLength:M}=n;return l("label",{style:{display:"flex",flexDirection:"column",borderBottom:"1px solid rgba(0,0,0,0.1)",paddingLeft:"1rem",paddingRight:"1rem",...p}},null,[s&&l("div",null,{style:{fontSize:"0.8rem",color:I,lineHeight:"0.8rem"}},s,1,"zg_14"),l("input",{placeholder:m,name:i,value:o,type:y,inputMode:a,required:d,pattern:P,disabled:b,maxLength:M,onChange$:f(()=>_(()=>import("./q-D2-AhDSC.js"),[]),"s_KfJVZd9TUDI",[e])},{style:{padding:"0.5rem 0",fontSize:"1.2rem",color:z}},null,2,null),r&&l("div",null,{style:{fontSize:"0.6rem",color:I,marginBottom:"0.5rem"}},r,1,"zg_15")],1,"zg_16")}const j=()=>{const[n,o]=v(),e=localStorage.getItem("user");if(e){const i=JSON.parse(e);n.userId=i.userId,n.fullName=i.fullName,n.email=i.email,o.viewMode="loggedIn"}},E=Object.freeze(Object.defineProperty({__proto__:null,_hW:h,s_6hzE8107fD4:j},Symbol.toStringTag,{value:"Module"})),C=x(f(()=>_(()=>import("./q-BLbZb5VG.js").then(n=>n.c),[]),"s_Ux732JtFVjc")),R=n=>{S();const o=w(T),e=B({viewMode:"signIn",isBusy:!1});return N("load",f(()=>_(()=>Promise.resolve().then(()=>E),void 0),"s_6hzE8107fD4",[o,e])),D(f(()=>_(()=>Promise.resolve().then(()=>U),void 0),"s_vN550zUCj0s",[o,e])),l("form",null,{id:u(i=>i.id,[n]),style:{display:"none",position:"absolute",top:0,width:"100%",height:"100%",flexDirection:"column",background:"whitesmoke",padding:"1.5rem",paddingBottom:"5rem",overflow:"auto",gap:"1rem"},"preventdefault:submit":!0,onSubmit$:f(()=>_(()=>Promise.resolve().then(()=>L),void 0),"s_w4nX4XxywlM",[o,e])},[l("div",null,{style:{fontWeight:500,fontSize:"1.5rem",paddingLeft:"1rem",paddingRight:"1rem"}},"Welcome to Wezo",3,null),e.viewMode==="registerPin"&&l("div",null,{style:{display:"flex",flexDirection:"column",paddingLeft:"1rem",paddingRight:"1rem",gap:"1rem"}},[l("div",null,null,["Hi ",u(i=>i.email,[e]),","],3,null),l("div",null,null,"Weâ€™re excited to welcome you onboard. To complete your registration, please provide your full name as it appears on your passport or goverment ID card, along with a 4-digit PIN that you will use for future logins.",3,null),l("div",null,null,"Best regards,",3,null)],3,"zg_0"),e.viewMode==="waitingEmailVerification"&&l("div",null,{style:{display:"flex",flexDirection:"column",paddingLeft:"1rem",paddingRight:"1rem",gap:"1rem"}},[l("div",null,null,["Hi ",u(i=>i.email,[e]),","],3,null),l("div",null,null,"We have sent a verification email to the address you provided. Please check your inbox and click the link in the email to complete the verification process.",3,null),l("div",null,null,"Best regards,",3,null)],3,"zg_1"),l("div",null,{style:{display:"flex",flexDirection:"column",border:"1px solid rgba(0,0,0,0.1)",borderRadius:"1rem",boxShadow:"rgba(0, 0, 0, 0.2) 0px 6px 20px 0px",marginBottom:"1rem"}},[e.viewMode==="loggedIn"&&l("div",null,{style:{display:"flex",flexDirection:"column",gap:"1rem",paddingTop:"1rem",paddingBottom:"1rem"}},[c(g,{name:"email",type:"text",title:"Email",inputMode:"email",disabled:!0,required:!0,get value(){return o.email},[t]:{name:t,type:t,title:t,inputMode:t,disabled:t,required:t,value:u(i=>i.email,[o])}},3,"zg_2"),c(g,{name:"fullName",type:"text",title:"Full Name",inputMode:"text",placeholder:"Full Name",disabled:!0,required:!0,style:{borderBottom:"none"},get value(){return o.fullName},[t]:{name:t,type:t,title:t,inputMode:t,placeholder:t,disabled:t,required:t,style:t,value:u(i=>i.fullName,[o])}},3,"zg_3")],1,"zg_4"),e.viewMode==="signIn"&&l("div",null,{style:{display:"flex",flexDirection:"column",gap:"1rem",paddingTop:"1rem",paddingBottom:"1rem"}},c(g,{name:"email",type:"text",inputMode:"email",placeholder:"Email",required:!0,style:{borderBottom:"none"},get disabled(){return e.isBusy},description:"Please provide your email address.",[t]:{name:t,type:t,inputMode:t,placeholder:t,required:t,style:t,disabled:u(i=>i.isBusy,[e]),description:t}},3,"zg_5"),1,"zg_6"),e.viewMode==="enterPin"&&l("div",null,{style:{display:"flex",flexDirection:"column",gap:"1rem",paddingTop:"1rem",paddingBottom:"1rem"}},c(g,{name:"pin",type:"number",inputMode:"numeric",placeholder:"Enter PIN",required:!0,style:{borderBottom:"none"},get disabled(){return e.isBusy},description:"Please provide your 4-digit PIN.",[t]:{name:t,type:t,inputMode:t,placeholder:t,required:t,style:t,disabled:u(i=>i.isBusy,[e]),description:t}},3,"zg_7"),1,"zg_8"),e.viewMode==="registerPin"&&l("div",null,{style:{display:"flex",flexDirection:"column",gap:"1rem",paddingTop:"1rem",paddingBottom:"1rem"}},[c(g,{name:"fullName",type:"text",inputMode:"text",placeholder:"Full name",required:!0,get disabled(){return e.isBusy},description:"Provide your full name as it appears in your passport.",[t]:{name:t,type:t,inputMode:t,placeholder:t,required:t,disabled:u(i=>i.isBusy,[e]),description:t}},3,"zg_9"),c(g,{name:"pin",type:"number",inputMode:"numeric",placeholder:"PIN",required:!0,get disabled(){return e.isBusy},style:{borderBottom:"none"},maxLength:4,description:"Please provide your 4-digit PIN.",[t]:{name:t,type:t,inputMode:t,placeholder:t,required:t,disabled:u(i=>i.isBusy,[e]),style:t,maxLength:t,description:t}},3,"zg_10")],1,"zg_11")],1,null),c(C,{get title(){return e.viewMode==="loggedIn"?"Sign Out":"Continue"},type:"submit",get isBusy(){return e.isBusy},[t]:{title:u(i=>i.viewMode==="loggedIn"?"Sign Out":"Continue",[e]),type:t,isBusy:u(i=>i.isBusy,[e])}},3,"zg_12")],1,"zg_13")},O=Object.freeze(Object.defineProperty({__proto__:null,s_Iguj0Nys0VI:R},Symbol.toStringTag,{value:"Module"})),q=async n=>{const[o,e]=v();e.isBusy=!0;const i=new FormData(n.target),s={email:i.get("email"),pin:i.get("pin"),fullName:i.get("fullName")};if(e.viewMode==="signIn"){const m=`action=user-sign-in&email=${encodeURIComponent(s.email)}`,r=await(await fetch(`https://script.google.com/macros/s/AKfycbx_Ic3SkntyjIDhTxDf-BWJkISCZP0cxDi6rGsHcT36S35K4P_cNnP-TSP2L__UqARH/exec?${m}`)).json();r.status==="success"?r.message==="ENTER_PIN_TO_PROCEED"?(e.email=s.email,e.viewMode="enterPin"):(e.email=s.email,e.viewMode="waitingEmailVerification"):alert(r.message),e.isBusy=!1;return}if(e.viewMode==="registerPin"){const m=e.userId??"",p=s.pin??"",r=s.fullName??"",y=`action=user-register-pin&userId=${encodeURIComponent(m)}&fullName=${encodeURIComponent(r)}&pin=${encodeURIComponent(p)}`,d=await(await fetch(`https://script.google.com/macros/s/AKfycbx_Ic3SkntyjIDhTxDf-BWJkISCZP0cxDi6rGsHcT36S35K4P_cNnP-TSP2L__UqARH/exec?${y}`)).json();d.status==="success"?(localStorage.setItem("user",JSON.stringify({userId:d.userId,fullName:d.fullName,email:d.email})),o.userId=d.userId,o.fullName=d.fullName,o.email=d.email,e.viewMode="loggedIn"):alert(d.message),e.isBusy=!1;return}if(e.viewMode==="loggedIn"){localStorage.removeItem("user"),o.userId="",o.fullName="",o.email="",e.viewMode="signIn",e.isBusy=!1;return}if(e.viewMode==="enterPin"){const m=e.email??"",p=s.pin??"",r=`action=user-validate-pin&email=${encodeURIComponent(m)}&pin=${encodeURIComponent(p)}`,a=await(await fetch(`https://script.google.com/macros/s/AKfycbx_Ic3SkntyjIDhTxDf-BWJkISCZP0cxDi6rGsHcT36S35K4P_cNnP-TSP2L__UqARH/exec?${r}`)).json();a.status==="success"?(localStorage.setItem("user",JSON.stringify({userId:a.userId,fullName:a.fullName,email:a.email})),o.userId=a.userId,o.fullName=a.fullName,o.email=a.email,e.viewMode="loggedIn",location.hash.startsWith("#!")&&(history.replaceState(null,"",location.pathname+location.search),location.reload())):alert(a.message),e.isBusy=!1;return}if(e.viewMode==="waitingEmailVerification"){e.viewMode="signIn",e.isBusy=!1;return}e.isBusy=!1},L=Object.freeze(Object.defineProperty({__proto__:null,s_w4nX4XxywlM:q},Symbol.toStringTag,{value:"Module"})),A=async({track:n})=>{const[o,e]=v();if(n(()=>o.page),n(()=>o.params),o.page==="my-profile"&&o.params.length>0&&o.params[0]==="verification"){const i=o.params[1],s=o.params[2];e.isBusy=!0;const m=`action=user-validate-token&email=${encodeURIComponent(i)}&token=${encodeURIComponent(s)}`;(await(await fetch(`https://script.google.com/macros/s/AKfycbx_Ic3SkntyjIDhTxDf-BWJkISCZP0cxDi6rGsHcT36S35K4P_cNnP-TSP2L__UqARH/exec?${m}`)).json()).status==="success"&&(e.userId=s,e.email=i,e.viewMode="registerPin"),e.isBusy=!1}},U=Object.freeze(Object.defineProperty({__proto__:null,_hW:h,s_vN550zUCj0s:A},Symbol.toStringTag,{value:"Module"}));export{C as B,K as M,h as _hW,j as s_6hzE8107fD4,R as s_Iguj0Nys0VI,A as s_vN550zUCj0s,q as s_w4nX4XxywlM};
