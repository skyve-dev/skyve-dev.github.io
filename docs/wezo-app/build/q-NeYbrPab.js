import{c as x,q as f,B as l,u as h,A as S,a as M,p as B,G as N,o as z,i as c,h as u,j as t,_hW as P}from"./q-DZXsFSfu.js";import{_ as y}from"./q-BUuyHtLx.js";import{A as D}from"./q-6NXEj_re.js";import{a as I,f as T}from"./q-BLbZb5VG.js";import"./q-SGYh504o.js";import"./q-BME3mVt-.js";const K=x(f(()=>y(()=>Promise.resolve().then(()=>O),void 0),"s_Iguj0Nys0VI"));function g(n){const{value:i,onChange$:e,name:o,title:s,placeholder:m,style:p,description:r,type:_,inputMode:a,required:d,pattern:v,disabled:b,maxLength:w}=n;return l("label",{style:{display:"flex",flexDirection:"column",borderBottom:"1px solid rgba(0,0,0,0.1)",paddingLeft:"1rem",paddingRight:"1rem",...p}},null,[s&&l("div",null,{style:{fontSize:"0.8rem",color:I,lineHeight:"0.8rem"}},s,1,"zg_15"),l("input",{placeholder:m,name:o,value:i,type:_,inputMode:a,required:d,pattern:v,disabled:b,maxLength:w,onChange$:f(()=>y(()=>import("./q-D2-AhDSC.js"),[]),"s_KfJVZd9TUDI",[e])},{style:{padding:"0.5rem 0",fontSize:"1.2rem",color:T}},null,2,null),r&&l("div",null,{style:{fontSize:"0.6rem",color:I,marginBottom:"0.5rem"}},r,1,"zg_16")],1,"zg_17")}const j=()=>{const[n,i]=h(),e=localStorage.getItem("user");if(e){const o=JSON.parse(e);n.userId=o.userId,n.fullName=o.fullName,n.email=o.email,i.viewMode="loggedIn"}},E=Object.freeze(Object.defineProperty({__proto__:null,_hW:P,s_6hzE8107fD4:j},Symbol.toStringTag,{value:"Module"})),C=x(f(()=>y(()=>import("./q-BLbZb5VG.js").then(n=>n.c),[]),"s_Ux732JtFVjc")),R=n=>{S();const i=M(D),e=B({viewMode:"signIn",isBusy:!1});return N("load",f(()=>y(()=>Promise.resolve().then(()=>E),void 0),"s_6hzE8107fD4",[i,e])),z(f(()=>y(()=>Promise.resolve().then(()=>L),void 0),"s_vN550zUCj0s",[i,e])),l("form",null,{id:u(o=>o.id,[n]),style:{display:"none",position:"absolute",top:0,width:"100%",height:"100%",flexDirection:"column",background:"whitesmoke",padding:"1.5rem",paddingBottom:"5rem",overflow:"auto",gap:"1rem"},"preventdefault:submit":!0,onSubmit$:f(()=>y(()=>Promise.resolve().then(()=>U),void 0),"s_w4nX4XxywlM",[i,e])},[l("div",null,{style:{fontWeight:500,fontSize:"1.5rem",paddingLeft:"1rem",paddingRight:"1rem"}},"Welcome to Wezo",3,null),e.viewMode==="signIn"&&l("div",null,{style:{fontSize:"1rem",lineHeight:"1.8rem",padding:"1rem",color:I}},"Please enter your email address. If you are not yet registered with Wezo, a verification email will be sent to you to begin the account setup process. If you are already registered, you will be prompted to enter your PIN.",3,"zg_0"),e.viewMode==="registerPin"&&l("div",null,{style:{display:"flex",flexDirection:"column",paddingLeft:"1rem",paddingRight:"1rem",gap:"1rem"}},[l("p",null,null,["Hi ",u(o=>o.email,[e]),","],3,null),l("p",null,null,"Weâ€™re excited to welcome you onboard. To complete your registration, please provide your full name as it appears on your passport or goverment ID card, along with a 4-digit PIN that you will use for future logins.",3,null)],3,"zg_1"),e.viewMode==="waitingEmailVerification"&&l("div",null,{style:{fontSize:"1rem",lineHeight:"1.8rem",padding:"1rem",color:I}},[l("p",null,null,["Hi ",u(o=>o.email,[e]),","],3,null),l("p",null,null,"We have sent a verification email to the address you provided. Please check your inbox and click the link in the email to complete the verification process.",3,null)],3,"zg_2"),l("div",null,{style:{display:"flex",flexDirection:"column",border:"1px solid rgba(0,0,0,0.1)",borderRadius:"1rem",boxShadow:"rgba(0, 0, 0, 0.2) 0px 6px 20px 0px",marginBottom:"1rem"}},[e.viewMode==="loggedIn"&&l("div",null,{style:{display:"flex",flexDirection:"column",gap:"1rem",paddingTop:"1rem",paddingBottom:"1rem"}},[c(g,{name:"email",type:"text",title:"Email",inputMode:"email",disabled:!0,required:!0,get value(){return i.email},[t]:{name:t,type:t,title:t,inputMode:t,disabled:t,required:t,value:u(o=>o.email,[i])}},3,"zg_3"),c(g,{name:"fullName",type:"text",title:"Full Name",inputMode:"text",placeholder:"Full Name",disabled:!0,required:!0,style:{borderBottom:"none"},get value(){return i.fullName},[t]:{name:t,type:t,title:t,inputMode:t,placeholder:t,disabled:t,required:t,style:t,value:u(o=>o.fullName,[i])}},3,"zg_4")],1,"zg_5"),e.viewMode==="signIn"&&l("div",null,{style:{display:"flex",flexDirection:"column",gap:"1rem",paddingTop:"1rem",paddingBottom:"1rem"}},c(g,{name:"email",type:"text",inputMode:"email",placeholder:"Email",required:!0,style:{borderBottom:"none"},get disabled(){return e.isBusy},description:"Please provide your email address.",[t]:{name:t,type:t,inputMode:t,placeholder:t,required:t,style:t,disabled:u(o=>o.isBusy,[e]),description:t}},3,"zg_6"),1,"zg_7"),e.viewMode==="enterPin"&&l("div",null,{style:{display:"flex",flexDirection:"column",gap:"1rem",paddingTop:"1rem",paddingBottom:"1rem"}},c(g,{name:"pin",type:"number",inputMode:"numeric",placeholder:"Enter PIN",required:!0,style:{borderBottom:"none"},get disabled(){return e.isBusy},description:"Please provide your 4-digit PIN.",[t]:{name:t,type:t,inputMode:t,placeholder:t,required:t,style:t,disabled:u(o=>o.isBusy,[e]),description:t}},3,"zg_8"),1,"zg_9"),e.viewMode==="registerPin"&&l("div",null,{style:{display:"flex",flexDirection:"column",gap:"1rem",paddingTop:"1rem",paddingBottom:"1rem"}},[c(g,{name:"fullName",type:"text",inputMode:"text",placeholder:"Full name",required:!0,get disabled(){return e.isBusy},description:"Provide your full name as it appears in your passport.",[t]:{name:t,type:t,inputMode:t,placeholder:t,required:t,disabled:u(o=>o.isBusy,[e]),description:t}},3,"zg_10"),c(g,{name:"pin",type:"number",inputMode:"numeric",placeholder:"PIN",required:!0,get disabled(){return e.isBusy},style:{borderBottom:"none"},maxLength:4,description:"Please provide your 4-digit PIN.",[t]:{name:t,type:t,inputMode:t,placeholder:t,required:t,disabled:u(o=>o.isBusy,[e]),style:t,maxLength:t,description:t}},3,"zg_11")],1,"zg_12")],1,null),c(C,{get title(){return e.viewMode==="loggedIn"?"Sign Out":"Continue"},type:"submit",get isBusy(){return e.isBusy},[t]:{title:u(o=>o.viewMode==="loggedIn"?"Sign Out":"Continue",[e]),type:t,isBusy:u(o=>o.isBusy,[e])}},3,"zg_13")],1,"zg_14")},O=Object.freeze(Object.defineProperty({__proto__:null,s_Iguj0Nys0VI:R},Symbol.toStringTag,{value:"Module"})),q=async n=>{const[i,e]=h();e.isBusy=!0;const o=new FormData(n.target),s={email:o.get("email"),pin:o.get("pin"),fullName:o.get("fullName")};if(e.viewMode==="signIn"){const m=`action=user-sign-in&email=${encodeURIComponent(s.email)}`,r=await(await fetch(`https://script.google.com/macros/s/AKfycbx_Ic3SkntyjIDhTxDf-BWJkISCZP0cxDi6rGsHcT36S35K4P_cNnP-TSP2L__UqARH/exec?${m}`)).json();r.status==="success"?r.message==="ENTER_PIN_TO_PROCEED"?(e.email=s.email,e.viewMode="enterPin"):(e.email=s.email,e.viewMode="waitingEmailVerification"):alert(r.message),e.isBusy=!1;return}if(e.viewMode==="registerPin"){const m=e.userId??"",p=s.pin??"",r=s.fullName??"",_=`action=user-register-pin&userId=${encodeURIComponent(m)}&fullName=${encodeURIComponent(r)}&pin=${encodeURIComponent(p)}`,d=await(await fetch(`https://script.google.com/macros/s/AKfycbx_Ic3SkntyjIDhTxDf-BWJkISCZP0cxDi6rGsHcT36S35K4P_cNnP-TSP2L__UqARH/exec?${_}`)).json();if(d.status==="success"){if(localStorage.setItem("user",JSON.stringify({userId:d.userId,fullName:d.fullName,email:d.email})),i.userId=d.userId,i.fullName=d.fullName,i.email=d.email,e.viewMode="loggedIn",location.hash){const v=location.href.split("#")[0];location.replace(v)}}else alert(d.message);e.isBusy=!1;return}if(e.viewMode==="loggedIn"){localStorage.removeItem("user"),i.userId="",i.fullName="",i.email="",e.viewMode="signIn",e.isBusy=!1;return}if(e.viewMode==="enterPin"){const m=e.email??"",p=s.pin??"",r=`action=user-validate-pin&email=${encodeURIComponent(m)}&pin=${encodeURIComponent(p)}`,a=await(await fetch(`https://script.google.com/macros/s/AKfycbx_Ic3SkntyjIDhTxDf-BWJkISCZP0cxDi6rGsHcT36S35K4P_cNnP-TSP2L__UqARH/exec?${r}`)).json();a.status==="success"?(localStorage.setItem("user",JSON.stringify({userId:a.userId,fullName:a.fullName,email:a.email})),i.userId=a.userId,i.fullName=a.fullName,i.email=a.email,e.viewMode="loggedIn",location.hash.startsWith("#!")&&(history.replaceState(null,"",location.pathname+location.search),location.reload())):alert(a.message),e.isBusy=!1;return}if(e.viewMode==="waitingEmailVerification"){e.viewMode="signIn",e.isBusy=!1;return}e.isBusy=!1},U=Object.freeze(Object.defineProperty({__proto__:null,s_w4nX4XxywlM:q},Symbol.toStringTag,{value:"Module"})),A=async({track:n})=>{const[i,e]=h();if(n(()=>i.page),n(()=>i.params),i.page==="my-profile"&&i.params.length>0&&i.params[0]==="verification"){const o=i.params[1],s=i.params[2];e.isBusy=!0;const m=`action=user-validate-token&email=${encodeURIComponent(o)}&token=${encodeURIComponent(s)}`;(await(await fetch(`https://script.google.com/macros/s/AKfycbx_Ic3SkntyjIDhTxDf-BWJkISCZP0cxDi6rGsHcT36S35K4P_cNnP-TSP2L__UqARH/exec?${m}`)).json()).status==="success"&&(e.userId=s,e.email=o,e.viewMode="registerPin"),e.isBusy=!1}},L=Object.freeze(Object.defineProperty({__proto__:null,_hW:P,s_vN550zUCj0s:A},Symbol.toStringTag,{value:"Module"}));export{C as B,K as M,P as _hW,j as s_6hzE8107fD4,R as s_Iguj0Nys0VI,A as s_vN550zUCj0s,q as s_w4nX4XxywlM};
